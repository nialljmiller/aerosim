name: Build Windows Executable

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
    
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install pygame numpy PyOpenGL PyOpenGL_accelerate pyinstaller
    
    - name: Build with PyInstaller
      run: |
        pyinstaller --onefile --name FlightSimulator plane.py
    
    - name: Create Release
      id: create_release
      uses: softprops/action-gh-release@v1
      with:
        files: ./dist/FlightSimulator.exe
        name: Flight Simulator v${{ github.run_number }}
        tag_name: v${{ github.run_number }}
        body: |
          # 3D Flight Simulator
          
          This is a Windows executable for a 3D flight simulator with procedural terrain, dynamic weather, a day/night cycle, and realistic flight physics.
          
          ## Installation
          1. Download the FlightSimulator.exe file
          2. No installation needed - just double-click to run!
          
          ## Controls:
          - **UP/DOWN**: Pitch control
          - **LEFT/RIGHT**: Roll control
          - **A/D**: Yaw control
          - **W/S**: Throttle up/down
          - **0-5**: Throttle presets
          - **G**: Toggle landing gear
          - **F**: Adjust flaps
          - **R**: Reset position
          - **TAB**: Toggle wireframe view
          
          ## System Requirements:
          - Windows PC with OpenGL support
          - 4GB RAM recommended
          - Graphics card with OpenGL 3.3+ support
        draft: false
        prerelease: false
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
